function module(e,t,n){var r,a,i,u,o,l,c,s,d,f,m,p,v,h,b,k,x,S,T,g,y,E,w,A,I,_,D,R,B,C,M,V,z,L,U,N,P,j,q,W,F;function K(){var e=a(["left: 0; top: 0;"]);return K=function(){return e},e}n.link("@babel/runtime/helpers/extends",{default:function(e){r=e}},0),n.link("@babel/runtime/helpers/taggedTemplateLiteralLoose",{default:function(e){a=e}},1),n.link("@babel/runtime/helpers/objectWithoutProperties",{default:function(e){i=e}},2),n.link("@babel/runtime/helpers/toConsumableArray",{default:function(e){u=e}},3),n.link("@babel/runtime/helpers/objectSpread2",{default:function(e){o=e}},4),n.link("@babel/runtime/helpers/slicedToArray",{default:function(e){l=e}},5),n.link("react",{default:function(e){c=e},useState:function(e){s=e},useMemo:function(e){d=e},useEffect:function(e){f=e},useRef:function(e){m=e}},0),n.link("meteor/meteor",{Meteor:function(e){p=e}},1),n.link("@rocket.chat/fuselage",{Sidebar:function(e){v=e},TextInput:function(e){h=e},Box:function(e){b=e},Icon:function(e){k=e}},2),n.link("@rocket.chat/fuselage-hooks",{useMutableCallback:function(e){x=e},useDebouncedValue:function(e){S=e},useStableArray:function(e){T=e},useResizeObserver:function(e){g=e},useAutoFocus:function(e){y=e},useUniqueId:function(e){E=e}},3),n.link("memoize-one",{default:function(e){w=e}},4),n.link("@rocket.chat/css-in-js",{css:function(e){A=e}},5),n.link("react-window",{FixedSizeList:function(e){I=e}},6),n.link("tinykeys",{default:function(e){_=e}},7),n.link("../../components/UserStatus",{ReactiveUserStatus:function(e){D=e}},8),n.link("../../contexts/TranslationContext",{useTranslation:function(e){R=e}},9),n.link("../hooks/usePreventDefault",{usePreventDefault:function(e){B=e}},10),n.link("../../contexts/SettingsContext",{useSetting:function(e){C=e}},11),n.link("../../../app/utils",{roomTypes:function(e){M=e}},12),n.link("../../contexts/UserContext",{useUserPreference:function(e){V=e},useUserSubscriptions:function(e){z=e}},13),n.link("../RoomList",{itemSizeMap:function(e){L=e},SideBarItemTemplateWithData:function(e){U=e}},14),n.link("../hooks/useTemplateByViewMode",{useTemplateByViewMode:function(e){N=e}},15),n.link("../hooks/useAvatarTemplate",{useAvatarTemplate:function(e){P=e}},16),n.link("../../../lib/escapeRegExp",{escapeRegExp:function(e){j=e}},17),n.link("../../hooks/useMethodData",{useMethodData:function(e){q=e}},18),n.link("../../hooks/useAsyncState",{AsyncStatePhase:function(e){W=e}},19),n.link("../../components/ScrollableContentWrapper",{default:function(e){F=e}},20);var O=w((function(e,t,n,r,a,i,u){return{items:e,t:t,SideBarItemTemplate:n,AvatarTemplate:r,useRealName:a,extended:i,sidebarViewMode:u}})),$=c.memo((function(e){var t=e.data,n=e.index,r=e.style,a=t.items,i=t.t,u=t.SideBarItemTemplate,o=t.AvatarTemplate,l=t.useRealName,s=t.extended,d=a[n];return"d"!==d.t||d.u?c.createElement(U,{id:"search-"+d._id,tabIndex:-1,extended:s,style:r,t:i,room:d,SideBarItemTemplate:u,AvatarTemplate:o}):c.createElement(G,{id:"search-"+d._id,useRealName:l,style:r,t:i,item:d,SideBarItemTemplate:u,AvatarTemplate:o})})),G=c.memo((function(e){var t=e.item,n=e.id,r=e.style,a=e.t,i=e.SideBarItemTemplate,u=e.AvatarTemplate,o=e.useRealName,l=e.sidebarViewMode,s=o?t.fname||t.name:t.name||t.fname,d="medium"!==l,f=c.createElement(v.Item.Icon,null,c.createElement(D,{small:d&&"small",uid:t._id})),m=M.getRouteLink(t.t,t);return c.createElement(i,{is:"a",id:n,href:m,title:s,subtitle:a("No_messages_yet"),avatar:u&&c.createElement(u,t),icon:f,style:r})})),H=p.Device.isDesktop()?window.navigator.platform.toLowerCase().includes("mac")?"(⌘+K)":"(⌃+K)":"",J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=/(@|#)?(.*)/i,r=e.match(n),a=l(r,3),i=a[1],u=a[2],o="#"===i,c="@"===i,s=d((function(){return o?{users:!1,rooms:!0}:c?{users:!0,rooms:!1}:{users:!0,rooms:!0}}),[o,c]),f=d((function(){return[u,t,s]}),[s,u,t]),m=q("spotlight",f),p=m.value,v=void 0===p?{users:[],rooms:[]}:p,h=m.phase;return d((function(){return v?{data:v,status:h}:{data:{users:[],rooms:[]},status:"loading"}}),[v,h])},Q={sort:{lm:-1,name:1}},X=function(e){var t=/(@|#)?(.*)/i,n=e.match(t),r=l(n,3),a=r[1],i=r[2],c=d((function(){var e=new RegExp(j(i),"i");return o({$or:[{name:e},{fname:e}]},a&&{t:"@"===a?"d":{$ne:"d"}})}),[i,a]),s=z(c,Q),f=T(u(null==s?void 0:s.map((function(e){var t=e.t,n=e.name;return"d"===t?n:null}))).filter(Boolean)),m=J(e,f),p=m.data,v=m.status;return d((function(){var e=[],t=function(e,t,n){var r=e._id;return t===n.findIndex((function(e){return r===e._id}))},n=function(e){return!s.find((function(t){var n;return"d"===e.t&&(null===(n=e.uids)||void 0===n?void 0:n.length)>1&&e.uids.includes(t._id)||[t.rid,t._id].includes(e._id)}))},r=function(e){return!s.find((function(t){var n;return"d"===t.t&&2===(null===(n=t.uids)||void 0===n?void 0:n.length)&&t.uids.includes(e._id)}))},a=function(e){return{_id:e._id,t:"d",name:e.username,fname:e.name,avatarETag:e.avatarETag}},o=e.filter((function(e){return[e.usernamame,e.name,e.fname].includes(i)}));return e.push.apply(e,u(p.users.filter(t).filter(r).map(a))),e.push.apply(e,u(p.rooms.filter(n))),{data:Array.from(new Set([].concat(u(o),u(s),e))),status:v}}),[s,i,p])},Y=function(e){var t=s(e),n=l(t,2),r=n[0],a=n[1],i;return{value:r,onChange:x((function(e){a(e.currentTarget.value)})),setValue:a}},Z=function(e,t,n){n.setAttribute("aria-activedescendant",e.id),e.setAttribute("aria-selected",!0),e.classList.add("rcx-sidebar-item--selected"),t&&(t.setAttribute("aria-selected",!1),t.classList.remove("rcx-sidebar-item--selected"))},ee=c.forwardRef(function(){function e(e,t){var n=e.onClose,a=E(),u=R(),o=Y(""),l=o.setValue,s=i(o,["setValue"]),d=y(),p=m(),T=m(),w=m(0),D=V("sidebarViewMode"),M=C("UI_Use_Real_Name"),z=N(),U=P(),j=L(D),q="extended"===D,G=S(s.value,100),J=[u("Search"),H].filter(Boolean).join(" "),Q=X(G),ee=Q.data,te=Q.status,ne=O(ee,u,z,U,M,q,D),re=g({debounceDelay:100}),ae=re.ref,ie=re.contentBoxSize,ue=(ie=void 0===ie?{}:ie).blockSize,oe=void 0===ue?750:ue;B(ae);var le=x((function(e){var t=null;return(t="up"===e?T.current.previousSibling:T.current.nextSibling)?(Z(t,T.current,d.current),t):T.current})),ce=x((function(){w.current=0,p.current.scrollToItem(w.current),T.current=ae.current.querySelector("a.rcx-sidebar-item"),T.current&&Z(T.current,void 0,d.current)}));return f((function(){ce()}),[G,ce]),f((function(){if(d.current){var e=_(d.current,{Escape:function(e){e.preventDefault(),l((function(e){return e||n(),ce(),""}))},Tab:n,ArrowUp:function(){w.current=Math.max(w.current-1,0),p.current.scrollToItem(w.current);var e=le("up");T.current=e},ArrowDown:function(){var e=le("down");T.current=e,w.current=Math.min(w.current+1,(null==ee?void 0:ee.length)+1),p.current.scrollToItem(w.current)},Enter:function(){T.current&&T.current.click()}});return function(){e()}}}),[d,le,null==ee?void 0:ee.length,n,ce,l]),c.createElement(b,{position:"absolute","rcx-sidebar":!0,h:"full",display:"flex",flexDirection:"column",zIndex:99,w:"full",className:A(K()),ref:t},c.createElement(v.TopBar.Section,{role:"search",is:"form"},c.createElement(h,r({"aria-owns":a,"data-qa":"sidebar-search-input",ref:d},s,{placeholder:J,addon:c.createElement(k,{name:"cross",size:"x20",onClick:n})}))),c.createElement(b,{"aria-expanded":"true",role:"listbox",id:a,tabIndex:-1,flexShrink:1,h:"full",w:"full",ref:ae,"data-qa":"sidebar-search-result",onClick:n,"aria-busy":te!==W.RESOLVED},c.createElement(I,{outerElementType:F,height:oe,itemCount:null==ee?void 0:ee.length,itemSize:j,itemData:ne,overscanCount:25,width:"100%",ref:p},$)))}return e}());n.exportDefault(ee)}

