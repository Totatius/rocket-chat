function module(e,n,t){var i,o,r,s,u,a,l,c,d,f,m,k,x,p,g,h,v,b,E,I,C,S,T,y,w,M,D,R,B,L,U,z,A,G,_;function N(e){return function(n){var t=n.msg,i=n.username,s=n.tcount,a=n.ts,l=r(n,["msg","username","tcount","ts"]);return(u.createElement(e,o({replies:s,username:i,msg:t,ts:a},l)))}}t.link("@babel/runtime/helpers/slicedToArray",{default:function(e){i=e}},0),t.link("@babel/runtime/helpers/extends",{default:function(e){o=e}},1),t.link("@babel/runtime/helpers/objectWithoutProperties",{default:function(e){r=e}},2),t.export({withData:function(){return O},normalizeThreadMessage:function(){return V},DiscussionList:function(){return q}}),t.link("meteor/kadira:flow-router",{FlowRouter:function(e){s=e}},0),t.link("react",{default:function(e){u=e},useCallback:function(e){a=e},useMemo:function(e){l=e},useState:function(e){c=e},useRef:function(e){d=e},memo:function(e){f=e}},1),t.link("@rocket.chat/fuselage",{Box:function(e){m=e},Icon:function(e){k=e},TextInput:function(e){x=e},Callout:function(e){p=e}},2),t.link("react-window",{FixedSizeList:function(e){g=e}},3),t.link("react-window-infinite-loader",{default:function(e){h=e}},4),t.link("@rocket.chat/fuselage-hooks",{useDebouncedValue:function(e){v=e},useResizeObserver:function(e){b=e}},5),t.link("../../../../components/VerticalBar",{default:function(e){E=e}},6),t.link("../../../../contexts/TranslationContext",{useTranslation:function(e){I=e}},7),t.link("../../../../contexts/UserContext",{useUserId:function(e){C=e},useUserSubscription:function(e){S=e}},8),t.link("../../../../hooks/useTimeAgo",{useTimeAgo:function(e){T=e}},9),t.link("../../components/Message",{MessageSkeleton:function(e){y=e}},10),t.link("../../hooks/useUserRoom",{useUserRoom:function(e){w=e}},11),t.link("../../../../contexts/SettingsContext",{useSetting:function(e){M=e}},12),t.link("./components/Message",{default:function(e){D=e}},13),t.link("../../../../lib/clickableItem",{clickableItem:function(e){R=e}},14),t.link("../../../../../lib/escapeHTML",{escapeHTML:function(e){B=e}},15),t.link("../../../../hooks/useAsyncState",{AsyncStatePhase:function(e){L=e}},16),t.link("../../../../components/ScrollableContentWrapper",{default:function(e){U=e}},17),t.link("../../providers/ToolboxProvider",{useTabBarClose:function(e){z=e}},18),t.link("../../../../lib/renderMessageBody",{renderMessageBody:function(e){A=e}},19),t.link("./useDiscussionsList",{useDiscussionsList:function(e){G=e}},20),t.link("../../../../hooks/lists/useRecordList",{useRecordList:function(e){_=e}},21);var F=u.memo(N(R(D))),H=u.memo(R(y)),P={tunread:1,tunreadUser:1,tunreadGroup:1},W={t:1,name:1};function O(e){return function(n){var t=n.rid,s=r(n,["rid"]),d=w(t,W),f=S(t,P),m=C(),k=z(),x=c(""),p=i(x,2),g=p[0],h=p[1],b=v(g,400),E=l((function(){return{rid:t,text:b}}),[t,b]),I=G(E,m),T=I.discussionsList,y=I.initialItemCount,M=I.loadMoreItems,D=_(T),R=D.phase,B=D.error,U=D.items,A=D.itemCount,N=a((function(e){h(e.currentTarget.value)}),[]);return u.createElement(e,o({},s,{onClose:k,unread:null==f?void 0:f.tunread,unreadUser:null==f?void 0:f.tunreadUser,unreadGroup:null==f?void 0:f.tunreadGroup,userId:m,error:B,discussions:U,total:A,initial:y,loading:R===L.LOADING,loadMoreItems:M,room:d,text:g,setText:N}))}}var V=function(e){var n=o({},e);if(n.msg)return A(n).replace(/<br\s?\\?>/g," ");if(n.attachments){var t=n.attachments.find((function(e){return e.title||e.description}));if(t&&t.description)return B(t.description);if(t&&t.title)return B(t.title)}},j=f(function(){function e(e){var n=e.data,t=e.index,i=e.style,r=e.showRealNames,s=e.userId,a=e.onClick,l=I(),c=T();if(!n[t])return u.createElement(H,{style:i});var d=n[t],f=V(d),m=d.u.name,k=void 0===m?d.u.username:m;return u.createElement(F,o({},d,{name:r?k:d.u.username,username:d.u.username,style:i,following:d.replies&&d.replies.includes(s),"data-drid":d.drid,msg:f,t:l,formatDate:c,onClick:a}))}return e}());function q(e){var n=e.total,t=void 0===n?10:n,i=e.initial,o=void 0===i?10:i,r=e.discussions,l=void 0===r?[]:r,c=e.loadMoreItems,f=e.loading,v=e.onClose,C=e.error,S=e.userId,T=e.text,y=e.setText,w=M("UI_Use_Real_Name"),D=d(),R=I(),B=a((function(e){var n=e.currentTarget.dataset.drid;s.goToRoomById(n)}),[]);D.current=l;var L=a((function(e){var n=e.data,t=e.index,i=e.style;return(u.createElement(j,{data:n,index:t,style:i,showRealNames:w,userId:S,onClick:B}))}),[B,w,S]),z=a((function(e){return e<D.current.length}),[]),A=b({debounceDelay:100}),G=A.ref,_=A.contentBoxSize,N=(_=void 0===_?{}:_).inlineSize,F=void 0===N?378:N,H=_.blockSize,P=void 0===H?750:H;return u.createElement(u.Fragment,null,u.createElement(E.Header,null,u.createElement(E.Icon,{name:"discussion"}),u.createElement(m,{flexShrink:1,flexGrow:1,withTruncatedText:!0,mi:"x8"},R("Discussions")),u.createElement(E.Close,{onClick:v})),u.createElement(E.Content,{paddingInline:0},u.createElement(m,{display:"flex",flexDirection:"row",p:"x24",borderBlockEndWidth:"x2",borderBlockEndStyle:"solid",borderBlockEndColor:"neutral-200",flexShrink:0},u.createElement(x,{placeholder:R("Search_Messages"),value:T,onChange:y,addon:u.createElement(k,{name:"magnifier",size:"x20"})})),u.createElement(m,{flexGrow:1,flexShrink:1,ref:G,overflow:"hidden",display:"flex"},C&&u.createElement(p,{mi:"x24",type:"danger"},C.toString()),0===t&&u.createElement(m,{p:"x24"},R("No_Discussions_found")),!C&&t>0&&u.createElement(h,{isItemLoaded:z,itemCount:t,loadMoreItems:f?function(){}:c},(function(e){var n=e.onItemsRendered,i=e.ref;return(u.createElement(g,{outerElementType:U,height:P,width:F,itemCount:t,itemData:l,itemSize:124,ref:i,minimumBatchSize:o,onItemsRendered:n},L))})))))}t.exportDefault(O(q))}

