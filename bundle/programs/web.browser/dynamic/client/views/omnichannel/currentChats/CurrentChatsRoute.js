function module(e,t,a){let n,l,r,o,s,c,i,d,m,u,k,C,h,p,f,v,y,g,x,E,T,w;function S(e){let{_id:t,reload:a}=e;const n=f("livechat:removeRoom"),l=E(),s=T(),c=p(),i=r(async()=>{try{await n(t)}catch(e){console.log(e)}a()}),k=r(e=>{e.stopPropagation();const t=async()=>{try{await i(),s({type:"success",message:c("Chat_removed")})}catch(e){s({type:"error",message:e})}l()};l(o.createElement(x,{onDelete:t,onCancel:()=>l()}))});return o.createElement(d.Cell,{fontScale:"p1",color:"hint",withTruncatedText:!0},o.createElement(u,{small:!0,ghost:!0,title:c("Remove"),onClick:k},o.createElement(m,{name:"trash",size:"x16"})))}a.link("@babel/runtime/helpers/objectSpread2",{default(e){n=e}},0),a.export({RemoveChatButton:()=>S}),a.link("@rocket.chat/fuselage-hooks",{useDebouncedValue(e){l=e},useMutableCallback(e){r=e}},0),a.link("react",{default(e){o=e},useMemo(e){s=e},useCallback(e){c=e},useState(e){i=e}},1),a.link("@rocket.chat/fuselage",{Table(e){d=e},Icon(e){m=e},Button(e){u=e}},2),a.link("moment",{default(e){k=e}},3),a.link("meteor/kadira:flow-router",{FlowRouter(e){C=e}},4),a.link("../../../components/GenericTable",{default(e){h=e}},5),a.link("../../../contexts/TranslationContext",{useTranslation(e){p=e}},6),a.link("../../../contexts/ServerContext",{useMethod(e){f=e}},7),a.link("../../../contexts/AuthorizationContext",{usePermission(e){v=e}},8),a.link("../../../components/NotAuthorizedPage",{default(e){y=e}},9),a.link("./CurrentChatsPage",{default(e){g=e}},10),a.link("../../../components/DeleteWarningModal",{default(e){x=e}},11),a.link("../../../contexts/ModalContext",{useSetModal(e){E=e}},12),a.link("../../../contexts/ToastMessagesContext",{useToastMessageDispatch(e){T=e}},13),a.link("../../../hooks/useEndpointData",{useEndpointData(e){w=e}},14);const b=e=>"asc"===e?1:-1,B=(e,t)=>{let{guest:a,servedBy:l,department:r,status:o,from:c,to:i,tags:d,customFields:m,itemsPerPage:u,current:k}=e,[C,h]=t;return s(()=>{const e=n({},a&&{roomName:a},{sort:JSON.stringify({[C]:b(h),ts:"ts"===C?b(h):void 0})},u&&{count:u},{},k&&{offset:k});return c&&i&&(e.createdAt=JSON.stringify({start:c,end:i})),"all"!==o&&(e.open="opened"===o),l&&"all"!==l&&(e.agents=[l]),r&&"all"!==r&&(e.departmentId=r),d&&d.length>0&&(e.tags=d),m&&Object.keys(m).length>0&&(e.customFields=JSON.stringify(m)),e},[a,C,h,u,k,c,i,o,l,r,d,m])};function M(){const e=p(),t=v("view-livechat-current-chats"),[a,n]=i({fname:"",servedBy:[],status:"",department:"",from:"",to:"",customFields:{},current:0,itemsPerPage:25}),[m,u]=i(["ts","desc"]),f=l(a,500),x=l(m,500),E=B(f,x),T=r(e=>{const[t,a]=m;u(t!==e?[e,"asc"]:[e,"asc"===a?"desc":"asc"])}),b=r(e=>{C.go("live",{id:e})}),{value:M,reload:P}=w("livechat/rooms",E),D=s(()=>[o.createElement(h.HeaderCell,{key:"name",direction:m[1],active:"name"===m[0],onClick:T,sort:"name"},e("Name")),o.createElement(h.HeaderCell,{key:"departmentId",direction:m[1],active:"departmentId"===m[0],onClick:T,sort:"departmentId"},e("Department")),o.createElement(h.HeaderCell,{key:"servedBy",direction:m[1],active:"servedBy"===m[0],onClick:T,sort:"servedBy"},e("Served_By")),o.createElement(h.HeaderCell,{key:"ts",direction:m[1],active:"ts"===m[0],onClick:T,sort:"ts"},e("Started_At")),o.createElement(h.HeaderCell,{key:"lm",direction:m[1],active:"lm"===m[0],onClick:T,sort:"lm"},e("Last_Message")),o.createElement(h.HeaderCell,{key:"status",direction:m[1],active:"status"===m[0],onClick:T,sort:"status",w:"x100"},e("Status")),o.createElement(h.HeaderCell,{key:"remove",w:"x60"},e("Remove"))].filter(Boolean),[m,T,e]),H=c(t=>{let{_id:a,fname:n,servedBy:l,ts:r,lm:s,department:c,open:i}=t;return(o.createElement(d.Row,{key:a,tabIndex:0,role:"link",onClick:()=>b(a),action:!0,"qa-user-id":a},o.createElement(d.Cell,{withTruncatedText:!0},n),o.createElement(d.Cell,{withTruncatedText:!0},c?c.name:""),o.createElement(d.Cell,{withTruncatedText:!0},l&&l.username),o.createElement(d.Cell,{withTruncatedText:!0},k(r).format("L LTS")),o.createElement(d.Cell,{withTruncatedText:!0},k(s).format("L LTS")),o.createElement(d.Cell,{withTruncatedText:!0},e(i?"Open":"Closed")),!i&&o.createElement(S,{_id:a,reload:P})))},[b,P,e]);return t?o.createElement(g,{setParams:n,params:a,onHeaderClick:T,data:M,useQuery:B,reload:P,header:D,renderRow:H,title:e("Current_Chats")}):o.createElement(y,null)}a.exportDefault(M)}

