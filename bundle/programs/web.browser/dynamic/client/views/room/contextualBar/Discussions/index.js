function module(e,t,n){let r,s,o,i,l,a,u,d,c,m,k,f,x,p,g,h,b,E,I,C,S,T,w,y,M,D,R,B,L,U,v,z,G,_;function A(e){return t=>{let{msg:n,username:o,tcount:l,ts:a}=t,u=s(t,["msg","username","tcount","ts"]);return(i.createElement(e,r({replies:l,username:o,msg:n,ts:a},u)))}}n.link("@babel/runtime/helpers/extends",{default(e){r=e}},0),n.link("@babel/runtime/helpers/objectWithoutProperties",{default(e){s=e}},1),n.export({withData:()=>W,normalizeThreadMessage:()=>O,DiscussionList:()=>j}),n.link("meteor/kadira:flow-router",{FlowRouter(e){o=e}},0),n.link("react",{default(e){i=e},useCallback(e){l=e},useMemo(e){a=e},useState(e){u=e},useRef(e){d=e},memo(e){c=e}},1),n.link("@rocket.chat/fuselage",{Box(e){m=e},Icon(e){k=e},TextInput(e){f=e},Callout(e){x=e}},2),n.link("react-window",{FixedSizeList(e){p=e}},3),n.link("react-window-infinite-loader",{default(e){g=e}},4),n.link("@rocket.chat/fuselage-hooks",{useDebouncedValue(e){h=e},useResizeObserver(e){b=e}},5),n.link("../../../../components/VerticalBar",{default(e){E=e}},6),n.link("../../../../contexts/TranslationContext",{useTranslation(e){I=e}},7),n.link("../../../../contexts/UserContext",{useUserId(e){C=e},useUserSubscription(e){S=e}},8),n.link("../../../../hooks/useTimeAgo",{useTimeAgo(e){T=e}},9),n.link("../../components/Message",{MessageSkeleton(e){w=e}},10),n.link("../../hooks/useUserRoom",{useUserRoom(e){y=e}},11),n.link("../../../../contexts/SettingsContext",{useSetting(e){M=e}},12),n.link("./components/Message",{default(e){D=e}},13),n.link("../../../../lib/clickableItem",{clickableItem(e){R=e}},14),n.link("../../../../../lib/escapeHTML",{escapeHTML(e){B=e}},15),n.link("../../../../hooks/useAsyncState",{AsyncStatePhase(e){L=e}},16),n.link("../../../../components/ScrollableContentWrapper",{default(e){U=e}},17),n.link("../../providers/ToolboxProvider",{useTabBarClose(e){v=e}},18),n.link("../../../../lib/renderMessageBody",{renderMessageBody(e){z=e}},19),n.link("./useDiscussionsList",{useDiscussionsList(e){G=e}},20),n.link("../../../../hooks/lists/useRecordList",{useRecordList(e){_=e}},21);const N=i.memo(A(R(D))),F=i.memo(R(w)),H={tunread:1,tunreadUser:1,tunreadGroup:1},P={t:1,name:1};function W(e){return t=>{let{rid:n}=t,o=s(t,["rid"]);const d=y(n,P),c=S(n,H),m=C(),k=v(),[f,x]=u(""),p=h(f,400),g=a(()=>({rid:n,text:p}),[n,p]),{discussionsList:b,initialItemCount:E,loadMoreItems:I}=G(g,m),{phase:T,error:w,items:M,itemCount:D}=_(b),R=l(e=>{x(e.currentTarget.value)},[]);return i.createElement(e,r({},o,{onClose:k,unread:null==c?void 0:c.tunread,unreadUser:null==c?void 0:c.tunreadUser,unreadGroup:null==c?void 0:c.tunreadGroup,userId:m,error:w,discussions:M,total:D,initial:E,loading:T===L.LOADING,loadMoreItems:I,room:d,text:f,setText:R}))}}const O=e=>{let t=r({},e);if(t.msg)return z(t).replace(/<br\s?\\?>/g," ");if(t.attachments){const e=t.attachments.find(e=>e.title||e.description);if(e&&e.description)return B(e.description);if(e&&e.title)return B(e.title)}},V=c((function e(t){let{data:n,index:s,style:o,showRealNames:l,userId:a,onClick:u}=t;const d=I(),c=T();if(!n[s])return i.createElement(F,{style:o});const m=n[s],k=O(m),{name:f=m.u.username}=m.u;return i.createElement(N,r({},m,{name:l?f:m.u.username,username:m.u.username,style:o,following:m.replies&&m.replies.includes(a),"data-drid":m.drid,msg:k,t:d,formatDate:c,onClick:u}))}));function j(e){let{total:t=10,initial:n=10,discussions:r=[],loadMoreItems:s,loading:a,onClose:u,error:c,userId:h,text:C,setText:S}=e;const T=M("UI_Use_Real_Name"),w=d(),y=I(),D=l(e=>{const{drid:t}=e.currentTarget.dataset;o.goToRoomById(t)},[]);w.current=r;const R=l(e=>{let{data:t,index:n,style:r}=e;return(i.createElement(V,{data:t,index:n,style:r,showRealNames:T,userId:h,onClick:D}))},[D,T,h]),B=l(e=>e<w.current.length,[]),{ref:L,contentBoxSize:{inlineSize:v=378,blockSize:z=750}={}}=b({debounceDelay:100});return i.createElement(i.Fragment,null,i.createElement(E.Header,null,i.createElement(E.Icon,{name:"discussion"}),i.createElement(m,{flexShrink:1,flexGrow:1,withTruncatedText:!0,mi:"x8"},y("Discussions")),i.createElement(E.Close,{onClick:u})),i.createElement(E.Content,{paddingInline:0},i.createElement(m,{display:"flex",flexDirection:"row",p:"x24",borderBlockEndWidth:"x2",borderBlockEndStyle:"solid",borderBlockEndColor:"neutral-200",flexShrink:0},i.createElement(f,{placeholder:y("Search_Messages"),value:C,onChange:S,addon:i.createElement(k,{name:"magnifier",size:"x20"})})),i.createElement(m,{flexGrow:1,flexShrink:1,ref:L,overflow:"hidden",display:"flex"},c&&i.createElement(x,{mi:"x24",type:"danger"},c.toString()),0===t&&i.createElement(m,{p:"x24"},y("No_Discussions_found")),!c&&t>0&&i.createElement(g,{isItemLoaded:B,itemCount:t,loadMoreItems:a?()=>{}:s},e=>{let{onItemsRendered:s,ref:o}=e;return(i.createElement(p,{outerElementType:U,height:z,width:v,itemCount:t,itemData:r,itemSize:124,ref:o,minimumBatchSize:n,onItemsRendered:s},R))}))))}n.exportDefault(W(j))}

