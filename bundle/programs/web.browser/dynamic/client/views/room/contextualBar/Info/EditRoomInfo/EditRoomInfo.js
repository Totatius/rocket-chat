function module(e,n,t){let l,o,a,r,i,c,s,d,m,u,E,h,p,y,f,R,x,w,C,b,g,_,v,k,A,P,M,O,S,G,T,D,j,N,L,F,I,B,H;t.link("@babel/runtime/helpers/objectWithoutProperties",{default(e){l=e}},0),t.link("@babel/runtime/helpers/objectSpread2",{default(e){o=e}},1),t.link("react",{default(e){a=e},useCallback(e){r=e},useMemo(e){i=e},useRef(e){c=e}},0),t.link("@rocket.chat/fuselage",{Field(e){s=e},TextInput(e){d=e},ToggleSwitch(e){m=e},MultiSelect(e){u=e},Accordion(e){E=e},Callout(e){h=e},NumberInput(e){p=e},FieldGroup(e){y=e},Button(e){f=e},ButtonGroup(e){R=e},Box(e){x=e},Icon(e){w=e},TextAreaInput(e){C=e}},1),t.link("@rocket.chat/fuselage-hooks",{useMutableCallback(e){b=e}},2),t.link("../../../../../components/VerticalBar",{default(e){g=e}},3),t.link("../../../../../components/RawText",{default(e){_=e}},4),t.link("../../../../../components/avatar/RoomAvatarEditor",{default(e){v=e}},5),t.link("../../../../../components/DeleteChannelWarning",{default(e){k=e}},6),t.link("../../../../../contexts/TranslationContext",{useTranslation(e){A=e}},7),t.link("../../../../../hooks/useForm",{useForm(e){P=e}},8),t.link("../../../../../../app/utils/client",{roomTypes(e){M=e},RoomSettingsEnum(e){O=e}},9),t.link("../../../../../../app/lib/lib/MessageTypes",{MessageTypesValues(e){S=e}},10),t.link("../../../../../contexts/ServerContext",{useMethod(e){G=e}},11),t.link("../../../../../contexts/ModalContext",{useSetModal(e){T=e}},12),t.link("../../../../../contexts/SettingsContext",{useSetting(e){D=e}},13),t.link("../../../../../contexts/AuthorizationContext",{usePermission(e){j=e},useAtLeastOnePermission(e){N=e},useRole(e){L=e}},14),t.link("../../../../../hooks/useEndpointAction",{useEndpointActionExperimental(e){F=e}},15),t.link("../../../hooks/useUserRoom",{useUserRoom(e){I=e}},16),t.link("../../../providers/ToolboxProvider",{useTabBarClose(e){B=e}},17),t.link("../../../../../../app/e2e/client/rocketchat.e2e",{e2e(e){H=e}},18);const q={c:"Channels",p:"Groups",d:"DMs"},J=(e,n)=>{const{t:t,ro:l,archived:a,topic:r,description:c,announcement:s,joinCodeRequired:d,sysMes:m,encrypted:u,retention:E={}}=e,{retentionPolicyEnabled:h,maxAgeDefault:p}=n,y=D("RetentionPolicy_AppliesTo".concat(q[e.t])),f=D("RetentionPolicy_DoNotPrunePinned"),R=D("RetentionPolicy_FilesOnly");return i(()=>{var n,i,x;return o({roomName:"d"===t?e.usernames.join(" x "):M.getRoomName(t,o({type:t},e)),roomType:t,readOnly:!!l,reactWhenReadOnly:!1,archived:!!a,roomTopic:null!=r?r:"",roomDescription:null!=c?c:"",roomAnnouncement:null!=s?s:"",roomAvatar:void 0,joinCode:"",joinCodeRequired:!!d,systemMessages:Array.isArray(m)?m:[],hideSysMes:!!(null==m?void 0:m.length),encrypted:u},h&&{retentionEnabled:null!==(n=E.enabled)&&void 0!==n?n:y,retentionOverrideGlobal:!!E.overrideGlobal,retentionMaxAge:Math.min(E.maxAge,p)||p,retentionExcludePinned:null!==(i=E.excludePinned)&&void 0!==i?i:f,retentionFilesOnly:null!==(x=E.filesOnly)&&void 0!==x?x:R})},[s,a,c,f,R,d,p,E.enabled,E.excludePinned,E.filesOnly,E.maxAge,E.overrideGlobal,y,h,l,e,m,t,r,u])};function W(e){let{rid:n,onClickBack:t}=e;const l=I(n),r=B();return a.createElement(V,{onClickClose:r,onClickBack:t,room:o({type:null==l?void 0:l.t},l)})}const U=(e,n,t,l)=>(!e.default||l)&&("p"===e.t&&n||"c"===e.t&&t);function V(e){let{room:n,onClickClose:t,onClickBack:I}=e;const B=A(),W=T(),V=D("RetentionPolicy_Enabled"),z=D("RetentionPolicy_MaxAge_".concat(q[n.t]))||30,Y=c({}),K=r(e=>{let{initialValue:n,value:t,key:l}=e;const{current:o}=Y;JSON.stringify(n)!==JSON.stringify(t)?o[l]=t:delete o[l]},[]),{values:Q,handlers:X,hasUnsavedChanges:Z,reset:$,commit:ee}=P(J(n,{retentionPolicyEnabled:V,maxAgeDefault:z}),K),ne=i(()=>S.map(e=>{let{key:n,i18nLabel:t}=e;return[n,B(t)]}),[B]),{roomName:te,roomType:le,readOnly:oe,encrypted:ae,roomAvatar:re,archived:ie,roomTopic:ce,roomDescription:se,roomAnnouncement:de,reactWhenReadOnly:me,joinCode:ue,joinCodeRequired:Ee,systemMessages:he,hideSysMes:pe,retentionEnabled:ye,retentionOverrideGlobal:fe,retentionMaxAge:Re,retentionExcludePinned:xe,retentionFilesOnly:we}=Q,{handleJoinCode:Ce,handleJoinCodeRequired:be,handleSystemMessages:ge,handleEncrypted:_e,handleHideSysMes:ve,handleRoomName:ke,handleReadOnly:Ae,handleArchived:Pe,handleRoomAvatar:Me,handleReactWhenReadOnly:Oe,handleRoomType:Se,handleRoomTopic:Ge,handleRoomDescription:Te,handleRoomAnnouncement:De,handleRetentionEnabled:je,handleRetentionOverrideGlobal:Ne,handleRetentionMaxAge:Le,handleRetentionExcludePinned:Fe,handleRetentionFilesOnly:Ie}=X,[Be,He,qe,Je,We,Ue,Ve,ze,Ye,Ke,Qe]=i(()=>{var e;const t=(null===(e=M.getConfig(n.t))||void 0===e?void 0:e.allowRoomSettingChange)||(()=>{});return[t(n,O.NAME),t(n,O.TOPIC),t(n,O.ANNOUNCEMENT),t(n,O.ARCHIVE_OR_UNARCHIVE),t(n,O.DESCRIPTION),t(n,O.TYPE),t(n,O.READ_ONLY),t(n,O.SYSTEM_MESSAGES),t(n,O.JOIN_CODE),t(n,O.REACT_WHEN_READ_ONLY),t(n,O.E2E)]},[n]),Xe=L("admin"),Ze=j("create-c"),$e=j("create-p"),en=U(n,Ze,$e,Xe),nn=j("set-readonly",n._id),tn=j("set-react-when-readonly",n._id),ln=j("edit-privileged-setting",n._id),on=N(i(()=>["archive-room","unarchive-room"],[])),an=j("delete-".concat(n.t)),rn=j("toggle-room-e2e-encryption",n._id)&&(n.encrypted||H.isReady()),cn=ie!==!!n.archived,sn=n.archived?"unarchive":"archive",dn=n.archived?"Room_has_been_unarchived":"Room_has_been_archived",mn=F("POST","rooms.saveRoomSettings",B("Room_updated_successfully")),un=F("POST","rooms.changeArchivationState",B(dn)),En=b(async()=>{const e=Y.current,{joinCodeRequired:t,hideSysMes:a}=e,r=l(e,["joinCodeRequired","hideSysMes"]);delete r.archived;const i=()=>mn(o({rid:n._id},r,{},ue&&{joinCode:t?ue:""},{},(r.systemMessages||!a)&&{systemMessages:a?he:[]})),c=()=>un({rid:n._id,action:sn});await Promise.all([Z&&i(),cn&&c()].filter(Boolean)),Y.current={},ee()}),hn=G("eraseRoom"),pn=b(()=>{const e=()=>W(void 0),t=async()=>{await hn(n._id),e()};W(a.createElement(k,{onConfirm:t,onCancel:e}))}),yn=b(()=>{Se("p"===le?"c":"p")}),fn=b(e=>{Le(Math.max(1,Number(e.currentTarget.value)))});return a.createElement(a.Fragment,null,a.createElement(g.Header,null,I&&a.createElement(g.Back,{onClick:I}),a.createElement(g.Text,null,B("edit-room")),t&&a.createElement(g.Close,{onClick:t})),a.createElement(g.ScrollableContent,{p:"x24",is:"form",onSubmit:b(e=>e.preventDefault())},a.createElement(x,{display:"flex",justifyContent:"center"},a.createElement(v,{room:n,roomAvatar:re,onChangeAvatar:Me})),a.createElement(s,null,a.createElement(s.Label,null,B("Name")),a.createElement(s.Row,null,a.createElement(d,{disabled:!Be,value:te,onChange:ke,flexGrow:1}))),We&&a.createElement(s,null,a.createElement(s.Label,null,B("Description")),a.createElement(s.Row,null,a.createElement(C,{rows:4,value:se,onChange:Te,flexGrow:1}))),qe&&a.createElement(s,null,a.createElement(s.Label,null,B("Announcement")),a.createElement(s.Row,null,a.createElement(C,{rows:4,value:de,onChange:De,flexGrow:1}))),He&&a.createElement(s,null,a.createElement(s.Label,null,B("Topic")),a.createElement(s.Row,null,a.createElement(C,{rows:4,value:ce,onChange:Ge,flexGrow:1}))),Ue&&a.createElement(s,null,a.createElement(x,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,B("Private")),a.createElement(s.Row,null,a.createElement(m,{disabled:!en,checked:"p"===le,onChange:yn}))),a.createElement(s.Hint,null,B("Just_invited_people_can_access_this_channel"))),Ve&&a.createElement(s,null,a.createElement(x,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,B("Read_only")),a.createElement(s.Row,null,a.createElement(m,{disabled:!nn,checked:oe,onChange:Ae}))),a.createElement(s.Hint,null,B("Only_authorized_users_can_write_new_messages"))),Ke&&a.createElement(s,null,a.createElement(x,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,B("React_when_read_only")),a.createElement(s.Row,null,a.createElement(m,{disabled:!tn,checked:me,onChange:Oe}))),a.createElement(s.Hint,null,B("Only_authorized_users_can_write_new_messages"))),Je&&a.createElement(s,null,a.createElement(x,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,B("Archived")),a.createElement(s.Row,null,a.createElement(m,{disabled:!on,checked:ie,onChange:Pe})))),Ye&&a.createElement(s,null,a.createElement(x,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,B("Password_to_access")),a.createElement(s.Row,null,a.createElement(m,{checked:Ee,onChange:be}))),a.createElement(s.Row,null,a.createElement(d,{disabled:!Ee,value:ue,onChange:Ce,placeholder:B("Reset_password"),flexGrow:1}))),ze&&a.createElement(s,null,a.createElement(x,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,B("Hide_System_Messages")),a.createElement(s.Row,null,a.createElement(m,{checked:pe,onChange:ve}))),a.createElement(s.Row,null,a.createElement(u,{options:ne,disabled:!pe,value:he,onChange:ge,placeholder:B("Select_an_option"),flexGrow:1}))),Qe&&a.createElement(s,null,a.createElement(x,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,B("Encrypted")),a.createElement(s.Row,null,a.createElement(m,{disabled:!rn,checked:ae,onChange:_e})))),V&&a.createElement(E,null,a.createElement(E.Item,{title:B("Prune")},a.createElement(y,null,a.createElement(s,null,a.createElement(x,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,B("RetentionPolicyRoom_Enabled")),a.createElement(s.Row,null,a.createElement(m,{checked:ye,onChange:je})))),a.createElement(s,null,a.createElement(x,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,B("RetentionPolicyRoom_OverrideGlobal")),a.createElement(s.Row,null,a.createElement(m,{disabled:!ye||!ln,checked:fe,onChange:Ne})))),fe&&a.createElement(a.Fragment,null,a.createElement(h,{type:"danger"},a.createElement(_,null,B("RetentionPolicyRoom_ReadTheDocs"))),a.createElement(s,null,a.createElement(s.Label,null,B("RetentionPolicyRoom_MaxAge",{max:z})),a.createElement(s.Row,null,a.createElement(p,{value:Re,onChange:fn,flexGrow:1}))),a.createElement(s,null,a.createElement(x,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,B("RetentionPolicyRoom_ExcludePinned")),a.createElement(s.Row,null,a.createElement(m,{checked:xe,onChange:Fe})))),a.createElement(s,null,a.createElement(x,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,B("RetentionPolicyRoom_FilesOnly")),a.createElement(s.Row,null,a.createElement(m,{checked:we,onChange:Ie})))))))),a.createElement(s,null,a.createElement(s.Row,null,a.createElement(x,{display:"flex",flexDirection:"row",justifyContent:"space-between",w:"full"},a.createElement(R,{stretch:!0,flexGrow:1},a.createElement(f,{type:"reset",disabled:!Z,onClick:$},B("Reset")),a.createElement(f,{flexGrow:1,disabled:!Z,onClick:En},B("Save")))))),a.createElement(s,null,a.createElement(s.Row,null,a.createElement(f,{flexGrow:1,primary:!0,danger:!0,disabled:!an,onClick:pn},a.createElement(w,{name:"trash",size:"x16"}),B("Delete"))))))}t.exportDefault(W)}

